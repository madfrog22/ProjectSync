<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/png" href="assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    

	<title>Form CRUD</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="assets/css/animate.min.css" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="assets/css/light-bootstrap-dashboard.css?v=1.4.0" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="assets/css/demo.css" rel="stylesheet" />


    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="assets/css/pe-icon-7-stroke.css" rel="stylesheet" />
</head>
<body>

<div class="wrapper">
    <div class="sidebar" data-color="purple" data-image="assets/img/sidebar-5.jpg">

    <!--   you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple" -->


    <div class="sidebar-wrapper">
        <div class="logo">
            <a href="http://www.creative-tim.com" class="simple-text">
                Dashboard
            </a>
        </div>

        <ul class="nav">
            <li>
                <a href="dashboard.html">
                    <i class="pe-7s-graph"></i>
                    <p>Dashboard</p>
                </a>
            </li>
            <li>
                <a href="teeest.html">
                    <i class="pe-7s-user"></i>
                    <p>Info Pelanggan</p>
                </a>
            </li>
            <li>
                <a href="table.html">
                    <i class="pe-7s-note2"></i>
                    <p>Unpaid List</p>
                </a>
            </li>
            <li class="active">
                <a href="table.html">
                    <i class="fab fa-wpforms"></i>
                    <p>Form CRUD</p>
                </a>
            </li>
            <!-- <li>
                <a href="typography.html">
                    <i class="pe-7s-news-paper"></i>
                    <p>Typography</p>
                </a>
            </li> -->
            <!-- <li>
                <a href="icons.html">
                    <i class="pe-7s-science"></i>
                    <p>Icons</p>
                </a>
            </li> -->
            <!-- <li>
                <a href="maps.html">
                    <i class="pe-7s-map-marker"></i>
                    <p>Maps</p>
                </a>
            </li> -->
            <li>
                <a href="notifications.html">
                    <i class="pe-7s-bell"></i>
                    <p>Notifications</p>
                </a>
            </li>
            <!-- <li class="active-pro">
                <a href="upgrade.html">
                    <i class="pe-7s-rocket"></i>
                    <p>Upgrade to PRO</p>
                </a>
            </li> -->
        </ul>
    </div>
    </div>

    <div class="main-panel">
		<nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Form CRUD</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-left">
                        <li>
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-dashboard"></i>
								<p class="hidden-lg hidden-md">Dashboard</p>
                            </a>
                        </li>
                        <li class="dropdown">
                              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="fa fa-globe"></i>
                                    <b class="caret hidden-sm hidden-xs"></b>
                                    <span class="notification hidden-sm hidden-xs">5</span>
									<p class="hidden-lg hidden-md">
										5 Notifications
										<b class="caret"></b>
									</p>
                              </a>
                              <ul class="dropdown-menu">
                                <li><a href="#">Notification 1</a></li>
                                <li><a href="#">Notification 2</a></li>
                                <li><a href="#">Notification 3</a></li>
                                <li><a href="#">Notification 4</a></li>
                                <li><a href="#">Another notification</a></li>
                              </ul>
                        </li>
                        <li>
                           <a href="teeest.html">
                                <i class="fa fa-search"></i>
								<p class="hidden-lg hidden-md">Search</p>
                            </a>
                        </li>
                    </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                           <a href="">
                               <p>Account</p>
                            </a>
                        </li>
                        <li class="dropdown">
                              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <p>
										Dropdown
										<b class="caret"></b>
									</p>

                              </a>
                              <ul class="dropdown-menu">
                                <li><a href="#">Action</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something</a></li>
                                <li class="divider"></li>
                                <li><a href="#">Separated link</a></li>
                              </ul>
                        </li>
                        <li>
                            <a href="#">
                                <p>Log out</p>
                            </a>
                        </li>
						<li class="separator hidden-lg hidden-md"></li>
                    </ul>
                </div>
            </div>
        </nav>


        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Form CRUD</h4>
                                <p class="category">Silahkan masukkan AccNum untuk update dan delete. Masukkan semua data dikolom untuk tambah data :</p>
                                <div class="input-group rounded"> 
                                    <h4>Insert Data, Update Data and Delete Data </h4>  
                                    <form>
                                        <label for="accNum">Account Number:</label><br>
                                        <input type="search" id="accNum" name="accNum" value=""> <input type="button" onclick="myFunction()" value="cari"><br>
                                        <label for="custName">Customer Name:</label><br>
                                        <input type="text" id="custName" name="custName" value="name"><br>
                                        <label for="status">Status Pembayaran:</label><br>
                                        <input type="text" id="status" name="status" value="status"><br>
                                        <label for="tglBayar">Tanggal Pembayaran:</label><br>
                                        <input type="date" id="tglBayar" name="tglBayar" value="tgl"><br>

                                        <label for="Layanan">Layanan:</label><br>
                                        <input type="text" id="Layanan" name="Layanan" value="Layanan"><br>
                                        <!-- <select name="Layanan" id="Layanan">
                                            <option value="" selected>Pilih Layanan</option>
                                            <option value="WIRELINE">Wireline</option>
                                            <option value="HSI">HSI</option>
                                            <option value="WIFI STATION">Wifi Station</option>
                                            <option value="WIFI Managed Srvice">WIFI Managed Srvice</option>
                                            <option value="ASTINET">Astinet</option>
                                            <option value="ASTINET LITE">ASTINET LITE</option>
                                            <option value="METRO">Metro</option>
                                            <option value="METRO-E">METRO-E</option>
                                            <option value="VPN">VPN</option>
                                            WIFI Managed Srvice
                                        </select><br> -->

                                        <label for="Bandwidth">Bandwidth:</label><br>
                                        <input type="text" id="Bandwidth" name="Bandwidth" value="Bandwidth"><br>

                                        <label for="Satuan">Satuan:</label><br>
                                        <input type="text" id="Satuan" name="Satuan" value="Mbps"><br>

                                        <label for="SID">SID:</label><br>
                                        <input type="text" id="SID" name="SID" value="SID"><br>

                                    </form> 
                                    
                                    <button onclick="InsertData()">Insert Data</button>  
                                    <button onclick="UpdateData()">Update Data</button>  
                                    <button onclick="ClearData()">Clear</button>  
                                    <br />  
                                    <br />  
                                    <br />  
                                    <div id="details"></div>  
                                </div> 
                            </div>
                            <!-- //bagian form disini -->                            
                            


                        </div>
                    </div>

                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="container-fluid">
                <nav class="pull-left">
                    <ul>
                        <li>
                            <a href="#">
                                Home
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                Company
                            </a>
                        </li>
                    </ul>
                </nav>
                <p class="copyright pull-right">
                    &copy; <script>document.write(new Date().getFullYear())</script> <a href="http://www.creative-tim.com">Creative Tim</a>, made with love for a better web
                </p>
            </div>
        </footer>


    </div>
</div>


</body>

        <!--   Core JS Files   -->
    <script src="assets/js/jquery.3.2.1.min.js" type="text/javascript"></script>
	<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>

    <!-- core fontAwesome -->
    <script src="https://kit.fontawesome.com/0f74922640.js" crossorigin="anonymous"></script>

	<!--  Charts Plugin -->
	<script src="assets/js/chartist.min.js"></script>

    <!--  Notifications Plugin    -->
    <script src="assets/js/bootstrap-notify.js"></script>

    <!--  Google Maps Plugin    -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>

    <!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
	<script src="assets/js/light-bootstrap-dashboard.js?v=1.4.0"></script>

	<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
	<script src="assets/js/demo.js"></script>
    <script src="https://kit.fontawesome.com/0f74922640.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
        function Notify(msg){
            $(document).ready(function(){

            demo.initChartist();

            $.notify({
                icon: 'pe-7s-gift',
                message: msg

            },{
                type: 'info',
                timer: 4000
            });

            });
        }
        function myFunction() {
            var x = document.getElementById("accNum").value;
                let xmlhttp = new XMLHttpRequest();
                xmlhttp.onreadystatechange= function() {
                    if(this.readyState == 4 && this.status== 200){
                        let data = JSON.parse(this.responseText).feed.entry;
                        let i;
                        // cuman 10 data head
                        let accNum = "" ;
                        let CustName = "" ;
                        let Status = "" ;
                        let tglBayar = "";
                        let layanan = "";
                        let bandwidth = "";
                        let satuan = "";
                        let sid = "";

                        for(i=0; i < data.length; i++){
                            
                            if(data[i]["gsx$accountnum"]["$t"] == x ){
                                accNum = data[i]["gsx$accountnum"]["$t"];
                                CustName = data[i]["gsx$custname"]["$t"];
                                Status = data[i]["gsx$status"]["$t"];
                                tglBayar = data[i]["gsx$tglbayar"]["$t"];
                                layanan = data[i]["gsx$layanan"]["$t"];
                                bandwidth = data[i]["gsx$bandwidth"]["$t"];
                                satuan = data[i]["gsx$detail"]["$t"];
                                sid = data[i]["gsx$sid"]["$t"];


                                console.log(CustName);
                                document.getElementById("accNum").value = accNum;
                                document.getElementById("custName").value = CustName;
                                document.getElementById("status").value = Status;
                                document.getElementById("tglBayar").value = tglBayar;
                                document.getElementById("Layanan").value = layanan;
                                document.getElementById("Bandwidth").value = bandwidth;
                                document.getElementById("Satuan").value = satuan;
                                document.getElementById("SID").value = sid;
                            }

                            
                        }
                        
                    }else{

                    }

                };
                //link untuk GSheet id/-- urutan nomer sheet mulai dari 1
                //link ghseet tidak boleh dalam format xlsx
                xmlhttp.open(
                    "GET",
                    "https://spreadsheets.google.com/feeds/list/1hgx9LagvcoIJOOTkvKuTuw-UjS4-Wcb0W_5oDFxA85w/14/public/values?alt=json",
                    true
                );
                xmlhttp.send();
        }
        function UpdateData(){
            let accNum = document.getElementById("accNum").value;
            let custName = document.getElementById("custName").value;
            let status = document.getElementById("status").value;
            let tglBayar = document.getElementById("tglBayar").value;
            let layanan = document.getElementById("Layanan").value;
            let bandwidth = document.getElementById("Bandwidth").value;
            let satuan = document.getElementById("Satuan").value;
            let sid = document.getElementById("SID").value;

            let queries = "select*from13671whereACCOUNT NUM=" +accNum;
            fetch("https://api.apispreadsheets.com/data/14786/", {
                method: "POST",
                body: JSON.stringify({"data": {"STATUS":status,"CUST NAME":custName,"TGL BAYAR":tglBayar}, "query": queries}),
                }).then(res =>{
                if (res.status === 201){
                    // SUCCESS
                    // console.log("wesbener")
                    let info ="Berhasil untuk Mengubah Data"
                    Notify(info)
                }
                else{
                    // ERROR
                    // alert("terjadi kesalahan mengubah data")
                    // console.log("rung bener");
                    let info = "Terjadi Kesalahan Mengubah Data"
                    Notify(info)
                }
            })
        }
        function ClearData(){
            document.getElementById("accNum").value = "";
            document.getElementById("custName").value = "";
            document.getElementById("status").value = "";
            document.getElementById("tglBayar").value = "";
            document.getElementById("Layanan").value = "";
            document.getElementById("Bandwidth").value = "";
            document.getElementById("Satuan").value = "";
            document.getElementById("SID").value = "";

        }
        function InsertData(){
            let accNum = document.getElementById("accNum").value;
            let custName = document.getElementById("custName").value;
            let status = document.getElementById("status").value;
            let tglBayar = document.getElementById("tglBayar").value;
            let layanan = document.getElementById("Layanan").value;
            let bandwidth = document.getElementById("Bandwidth").value;
            let satuan = document.getElementById("Satuan").value;
            let sid = document.getElementById("SID").value;
            fetch("https://api.apispreadsheets.com/data/14786/", {
            method: "POST",
            body: JSON.stringify({"data": {"STATUS":status,"CUST NAME":custName,"TGL BAYAR":tglBayar,"Layanan":layanan,"Bandwidth":bandwidth,"Detail":satuan,"SID":sid}}),
            }).then(res =>{
                if (res.status === 201){
                    // SUCCESS
                    console.log("wes bener")
                    let info = "berhasil untuk memasukkan data"
                    Notify(info)
                    document.getElementById("accNum").value = "";
                    document.getElementById("custName").value = "";
                    document.getElementById("status").value = "";
                    document.getElementById("tglBayar").value = "";
                }
                else{
                    // ERROR
                    console.log("ono sing salah");
                    let info = "terjadi kesalahan memasukkan data"
                    Notify(info)
                }
            })
        }
    </script>
</html>
